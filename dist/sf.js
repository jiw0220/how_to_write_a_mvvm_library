!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(4);t.SegmentFault=function(){function e(){this.viewModelPool={},this.viewViewModelMap={},this.renderer=new i.Renderer}return e.prototype.init=function(){var e=this,t=new r.Scanner(this.viewModelPool),n=new o.Watcher(this);for(var i in this.viewModelPool)n.observe(this.viewModelPool[i],this.viewModelChangedHandler);this.viewViewModelMap=t.scanBindDOM(),Object.keys(this.viewViewModelMap).forEach(function(t){e.refresh(t)})},e.prototype.registerViewModel=function(e,t){t._alias=e,window[e]=this.viewModelPool[e]=t},e.prototype.refresh=function(e){var t=this;this.viewViewModelMap[e].forEach(function(e){t.renderer.render(e)})},e.prototype.viewModelChangedHandler=function(e,t){this.refresh(e._alias)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=function(){function e(e){this.prefix="sf-",this.viewModelPool=e}return e.prototype.scanBindDOM=function(){var e=this,t={};return this.getAllBoundElements(this.prefix).forEach(function(n){for(var o=0;o<n.attributes.length;o++){var i=n.attributes[o];if(i.nodeName.search(e.prefix)>-1){var a=i.nodeName,s=n.getAttribute(a);for(var u in e.viewModelPool)if(-1!=s.search(u+".")){var c=new r.BoundItem(e.viewModelPool[u],n,s,a);t[u]?t[u].push(c):t[u]=[c]}}}}),t},e.prototype.fuzzyFind=function(e,t){if(e&&e.attributes)for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];if(r.nodeName.search(t)>-1)return e}return null},e.prototype.getAllBoundElements=function(e){for(var t=[],n=document.querySelectorAll("*"),r=0;r<n.length;r++){var o=n[r],i=this.fuzzyFind(o,e);i&&t.push(i)}return t},e}();t.Scanner=o},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BoundItem=function(){function BoundItem(e,t,n,r){this.interactiveDomConfig={INPUT:{text:"input",password:"input",email:"input",url:"input",tel:"input",radio:"change",checkbox:"change",color:"change",date:"change",datetime:"change","datetime-local":"change",month:"change",number:"change",range:"change",search:"change",time:"change",week:"change",button:"N/A",submit:"N/A"},SELECT:"change",TEXTAREA:"change"},this.viewModel=e,this.element=t,this.expression=n,this.attributeName=r,this.addListener(this.element,this.expression)}return BoundItem.prototype.addListener=function(element,expression){var tagName=element.tagName,eventName=this.interactiveDomConfig[tagName];if(eventName){if("object"==typeof eventName){var type=element.getAttribute("type");eventName=eventName[type]}element.addEventListener(eventName,function(e){var newValue=element.value,cmd=expression+'= "'+newValue+'"';try{eval(cmd)}catch(e){console.error(e)}})}},BoundItem}();exports.BoundItem=BoundItem},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.sf=e}return e.prototype.observe=function(e,t){var n=this.sf;for(var r in e){var o=e[r];!function(r,o){"_alias"!==r&&Object.defineProperty(e,r,{get:function(){return o},set:function(i){o=i,console.log("do something after set a new value"),t.call(n,e,r)}})}(r,o)}},e}();t.Watcher=r},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Renderer=function(){function Renderer(){}return Renderer.prototype.render=function(e){var t=this.getValue(e.viewModel,e.expression),n=e.attributeName.split("-")[1];"innertext"===n.toLowerCase()&&(n="innerText"),e.element[n]=t},Renderer.prototype.getValue=function(viewModel,expression){return function(){var alias=viewModel._alias,tempScope={};tempScope[alias]=viewModel;try{var pattern=new RegExp("\\b"+alias+"\\b","gm");expression=expression.replace(pattern,"tempScope."+alias);var result=eval(expression);return tempScope=null,result}catch(e){throw e}}()},Renderer}();exports.Renderer=Renderer}])});
//# sourceMappingURL=sf.js.map